<!-- 
// This file is part of Moodle - http://moodle.org/
//
// Moodle is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Moodle is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

/**
 * Cross Enrollment Tool
 *
 * @package   block_lsuxe
 * @copyright 2008 onwards Louisiana State University
 * @copyright 2008 onwards David Lowe, Robert Russo
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
-->

<div class="block_lsuxe_container">

    <table class="table table-hover table-striped lsuxe_moodles_table">
        <thead>
            <tr>
                {{#moodleURL}}
                    {{#isSortedAsc}}
                        <th><a href="?sort=url&dir=desc">{{# str }} moodlesurl, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_asc {{/pix}}</th>
                    {{/isSortedAsc}}

                    {{^isSortedAsc}}
                        <th><a href="?sort=url&dir=asc">{{# str }} moodlesurl, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_desc {{/pix}}</th>
                    {{/isSortedAsc}}
                {{/moodleURL}}
                {{^moodleURL}}
                    <th><a href="?sort=url&dir=asc">{{# str }} moodlesurl, block_lsuxe {{/ str }}</a></th>
                {{/moodleURL}}

                {{#moodleToken}}
                    {{#isSortedAsc}}
                        <th><a href="?sort=subject&dir=desc">{{# str }} token, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_asc {{/pix}}</th>
                    {{/isSortedAsc}}

                    {{^isSortedAsc}}
                        <th><a href="?sort=subject&dir=asc">{{# str }} token, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_desc {{/pix}}</th>
                    {{/isSortedAsc}}
                {{/moodleToken}}
                {{^moodleToken}}
                    <th><a href="?sort=subject&dir=asc">{{# str }} token, block_lsuxe {{/ str }}</a></th>
                {{/moodleToken}}

                {{#tokenExpiration}}
                    {{#isSortedAsc}}
                        <th><a href="?sort=sent&dir=desc">{{# str }} tokenexpiration, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_asc {{/pix}}</th>
                    {{/isSortedAsc}}

                    {{^isSortedAsc}}
                        <th><a href="?sort=sent&dir=asc">{{# str }} tokenexpiration, block_lsuxe {{/ str }}</a> {{#pix}} t/sort_desc {{/pix}}</th>
                    {{/isSortedAsc}}
                {{/tokenExpiration}}
                {{^tokenExpiration}}
                    <th><a href="?sort=sent&dir=asc">{{# str }} tokenexpiration, block_lsuxe {{/ str }}</a></th>
                {{/tokenExpiration}}

                <th>{{# str }} updateinterval, block_lsuxe {{/ str }}</th>
                <th>{{# str }} mappingslinked, block_lsuxe {{/ str }}</th>
                <th>{{# str }} updatenow, block_lsuxe {{/ str }}</th>
                <th>{{# str }} edit, block_lsuxe {{/ str }}</th>
                <th>{{# str }} delete, block_lsuxe {{/ str }}</th>
                
            </tr>
        </thead>
        <tbody>
            {{# moodles }}
            <form method="POST" id="map_form_{{id}}">
                <tr data-rowid='{{id}}' data-mlinks='{{mappingslinked}}'>
                    <input type="hidden" value="{{id}}" name="sentdata"/>
                    <td><a href="{{url}}" target="_blank">{{url}}</a></td>
                    <td><a href="{{url}}/admin/settings.php?section=webservicetokens" target="_blank">{{token}}</a></td>
                    <td>{{tokenexpire}}</td>
                    <td>{{{updateinterval}}}</td>
                    <td>{{mappingslinked}}</td>
                    <td><a href="{{xeurl}}/blocks/lsuxe/reprocess.php?{{xeparms}}{{id}}" class="btn btn-success mview_update"><i class="fa fa-refresh"></i></a></td>
                    <td><button type="submit" class="btn btn-warning mview_edit"><i class="fa fa-pencil"></i></button></td>
                    <td><button type="submit" class="btn btn-danger mview_delete"><i class="fa fa-trash"></i></button></td>
                </tr>
            </form>
            {{/ moodles }}

            {{^ moodles }}
                <tr>
                    <td colspan="7" align="center">{{# str }} nomoodles, block_lsuxe {{/ str }}</td>
                </tr>
            {{/ moodles }}

        </tbody>
    </table>
    <span class="pull-right">
        <a href="{{xeurl}}/blocks/lsuxe/moodles.php?vform=1" class="btn btn-info">Create New</a>
    </span>
    {{! This will load the JS for the views that have basic create, update, delete buttons }}
    {{> block_lsuxe/buttons }}
</div>

{"version":3,"sources":["../src/destcourse_source.js"],"names":["define","$","Ajax","Notification","XELib","getCourses","params","sessionStorage","getItem","jaxyRemotePromise","processResults","selector","results","options","each","index","data","push","value","id","shortname","label","transport","query","callback","then","catch","exception"],"mappings":"AAwBAA,OAAM,iCAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,mBAAxB,CAA6C,oBAA7C,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAgCC,CAAhC,CAAuC,CACvC,aACA,MAAO,CAQFC,UAAU,CAAE,oBAAUC,CAAV,CAAkB,CAC3B,GAAIA,CAAAA,CAAM,CAAG,CACT,KAAQ,KADC,CAET,IAAOC,cAAc,CAACC,OAAf,CAAuB,YAAvB,EAAuC,6BAFrC,CAGT,KAAQ,CACJ,QAAWD,cAAc,CAACC,OAAf,CAAuB,cAAvB,CADP,CAEJ,WAAc,yBAFV,CAGJ,mBAAsB,MAHlB,CAHC,CAAb,CASA,MAAOJ,CAAAA,CAAK,CAACK,iBAAN,CAAwBH,CAAxB,CACT,CAnBC,CA6BHI,cAAc,CAAE,wBAASC,CAAT,CAAmBC,CAAnB,CAA4B,CACxC,GAAIC,CAAAA,CAAO,CAAG,EAAd,CACAZ,CAAC,CAACa,IAAF,CAAOF,CAAP,CAAgB,SAASG,CAAT,CAAgBC,CAAhB,CAAsB,CAClCH,CAAO,CAACI,IAAR,CAAa,CACTC,KAAK,CAAEF,CAAI,CAACG,EAAL,CAAU,IAAV,CAAiBH,CAAI,CAACI,SADpB,CAETC,KAAK,CAAEL,CAAI,CAACI,SAFH,CAAb,CAIH,CALD,EAMA,MAAOP,CAAAA,CACV,CAtCE,CAiDHS,SAAS,CAAE,mBAASX,CAAT,CAAmBY,CAAnB,CAA0BC,CAA1B,CAAoC,CAC3C,KAAKnB,UAAL,GAAkBoB,IAAlB,CAAuBD,CAAvB,EAAiCE,KAAjC,CAAuCvB,CAAY,CAACwB,SAApD,CACH,CAnDE,CAsDV,CAzDK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Cross Enrollment Tool\n *\n * @package    block_lsuxe\n * @copyright  2008 onwards Louisiana State University\n * @copyright  2008 onwards David Lowe\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification', 'block_lsuxe/xe_lib'],\n    function($, Ajax, Notification, XELib) {\n    'use strict';\n    return {\n\n        /**\n         * Make an ajax call to the destination server and get courses.\n         *\n         * @param {Object} all the options to use jquery's $.ajax function (not moodle's)\n         * @return {Promise}\n         */\n         getCourses: function (params) {\n            var params = {\n                'type': 'GET',\n                'url': sessionStorage.getItem(\"currentUrl\") + '/webservice/rest/server.php',\n                'data': {\n                    'wstoken': sessionStorage.getItem(\"currentToken\"),\n                    'wsfunction': 'core_course_get_courses',\n                    'moodlewsrestformat': 'json'\n                }\n            };\n            return XELib.jaxyRemotePromise(params);\n         },\n\n        /**\n         * Process the results for auto complete elements. To keep the course id\n         * and name they have been concatenated as the value.\n         *\n         * @param {String} selector The selector of the auto complete element.\n         * @param {Array} results An array or results.\n         * @return {Array} New array of results.\n         */\n        processResults: function(selector, results) {\n            var options = [];\n            $.each(results, function(index, data) {\n                options.push({\n                    value: data.id + '__' + data.shortname,\n                    label: data.shortname\n                });\n            });\n            return options;\n        },\n\n        /**\n         * This is using a subclass of Moodle's autocomplete function in:\n         * classes/form/groupform_autocomplete.php\n         *\n         * @param {String} selector The selector of the auto complete element.\n         * @param {String} query The query string.\n         * @param {Function} callback A callback function receiving an array of results.\n         */\n        /* eslint-disable promise/no-callback-in-promise */\n        transport: function(selector, query, callback) {\n            this.getCourses().then(callback).catch(Notification.exception);\n        }\n    };\n\n});"],"file":"destcourse_source.min.js"}
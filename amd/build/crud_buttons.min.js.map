{"version":3,"file":"crud_buttons.min.js","names":["define","$","noti","XELib","registerEvents","on","ev","preventDefault","row_data","record","closest","data","this_form","title","body","save_button","callYesNoModi","then","response","status","append","submit","url","sessionStorage","getItem","pushPost","sentaction","sentdata","vform","links","callAlert","message","init"],"sources":["../src/crud_buttons.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Cross Enrollment Tool\n *\n * @package   block_lsuxe\n * @copyright 2008 onwards Louisiana State University\n * @copyright 2008 onwards David Lowe, Robert Russo\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'block_lsuxe/notifications', 'block_lsuxe/xe_lib'],\n    function($, noti, XELib) {\n    'use strict';\n    return {\n\n        /**\n         * Register click events for the page.\n         *\n         * @param null\n         * @return void\n         */\n        registerEvents: function () {\n\n            // --------------------------------\n            // Recover Mapping.\n            // --------------------------------\n            $('.block_lsuxe_container .mview_recover').on('click', function(ev) {\n                ev.preventDefault();\n                var row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"this_form\": $(this).closest(\"form\"),\n                    \"title\": 'Recover Mapping',\n                    \"body\": 'Do you really want to recover this?',\n                    \"save_button\": \"Recover\"\n                };\n\n                noti.callYesNoModi(row_data).then(function (response) {\n                    if (response.status == true) {\n                        var this_form = $('#map_form_'+response.data.record);\n                        // Convert all the form elements values to a serialised string.\n                        this_form.append('<input type=\"hidden\" name=\"sentaction\" value=\"recovered\" />');\n                        this_form.submit();\n                    // } else {\n                        // console.log(\"NOPE the thingy is false\");\n                    }\n                });\n            });\n\n            // --------------------------------\n            // Edit Mapping.\n            // --------------------------------\n            $('.block_lsuxe_container .mview_edit').on('click', function(ev) {\n                ev.preventDefault();\n                var record = $(this).closest(\"tr\").data(\"rowid\"),\n                    send_this = {\n                        \"sentaction\": \"update\",\n                        \"sentdata\": record,\n                        \"vform\": \"1\"\n                    },\n                    url = sessionStorage.getItem(\"wwwroot\") + \"/blocks/lsuxe/\" + sessionStorage.getItem(\"xe_form\") + \".php\";\n                XELib.pushPost(url, send_this);\n            });\n\n            // --------------------------------\n            // Delete Mapping.\n            // --------------------------------\n            $('.block_lsuxe_container .mview_delete').on('click', function(ev) {\n                ev.preventDefault();\n\n                var links = $(this).closest(\"tr\").data(\"mlinks\"),\n                row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"this_form\": $(this).closest(\"form\"),\n                    \"title\": 'Delete item',\n                    \"body\": 'Do you really want to delete?',\n                    \"save_button\": \"Delete\"\n                };\n\n                if (links > 1) {\n                    noti.callAlert({\n                        \"title\": \"Aborted\",\n                        \"message\": \"Cannot delete this while mappings are linked.\"\n                    });\n                } else {\n                    noti.callYesNoModi(row_data).then(function (response) {\n                        if (response.status == true) {\n                            var this_form = $('#map_form_' + response.data.record);\n                            // Convert all the form elements values to a serialised string.\n                            this_form.append('<input type=\"hidden\" name=\"sentaction\" value=\"delete\" />');\n                            this_form.submit();\n                        }\n                    });\n                }\n            });\n        },\n\n        /**\n         * Currently this is being called from the mustache templates when viewing lists.\n         * @param null\n         * @return void\n         */\n        init: function() {\n            var that = this;\n            // Register events.\n            that.registerEvents();\n        },\n    };\n});"],"mappings":"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"}
{"version":3,"sources":["../src/crud_buttons.js"],"names":["define","$","noti","XELib","registerEvents","on","ev","preventDefault","record","closest","data","url","sessionStorage","getItem","pushPost","row_data","callRemoveModi","then","response","status","this_form","append","submit","console","log","init","that"],"mappings":"AAwBCA,OAAM,4BAAC,CAAC,QAAD,CAAW,2BAAX,CAAwC,oBAAxC,CAAD,CACH,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CAAyB,CACzB,aACA,MAAO,CAQHC,cAAc,CAAE,yBAAY,CAExBH,CAAC,CAAC,sCAAD,CAAD,CAA0CI,EAA1C,CAA6C,OAA7C,CAAsD,UAAW,CAIhE,CAJD,EAMAJ,CAAC,CAAC,oCAAD,CAAD,CAAwCI,EAAxC,CAA2C,OAA3C,CAAoD,SAASC,CAAT,CAAa,CAC7DA,CAAE,CAACC,cAAH,GACA,GAAIC,CAAAA,CAAM,CAAGP,CAAC,CAAC,IAAD,CAAD,CAAQQ,OAAR,CAAgB,IAAhB,EAAsBC,IAAtB,CAA2B,OAA3B,CAAb,CAMIC,CAAG,CAAGC,cAAc,CAACC,OAAf,CAAuB,SAAvB,EAAoC,gBAApC,CAAuDD,cAAc,CAACC,OAAf,CAAuB,SAAvB,CAAvD,CAA2F,MANrG,CAOAV,CAAK,CAACW,QAAN,CAAeH,CAAf,CANgB,CACR,WAAc,QADN,CAER,SAAYH,CAFJ,CAGR,MAAS,GAHD,CAMhB,CACH,CAVD,EAYAP,CAAC,CAAC,sCAAD,CAAD,CAA0CI,EAA1C,CAA6C,OAA7C,CAAsD,SAASC,CAAT,CAAa,CAC/DA,CAAE,CAACC,cAAH,GAEA,GAAIQ,CAAAA,CAAQ,CAAG,CACX,OAAUd,CAAC,CAAC,IAAD,CAAD,CAAQQ,OAAR,CAAgB,IAAhB,EAAsBC,IAAtB,CAA2B,OAA3B,CADC,CAEX,UAAaT,CAAC,CAAC,IAAD,CAAD,CAAQQ,OAAR,CAAgB,MAAhB,CAFF,CAAf,CAKAP,CAAI,CAACc,cAAL,CAAoBD,CAApB,EAA8BE,IAA9B,CAAmC,SAAUC,CAAV,CAAoB,CACnD,GAAI,IAAAA,CAAQ,CAACC,MAAb,CAA6B,CACzB,GAAIC,CAAAA,CAAS,CAAGnB,CAAC,CAAC,aAAaiB,CAAQ,CAACR,IAAT,CAAcF,MAA5B,CAAjB,CAEAY,CAAS,CAACC,MAAV,CAAiB,gEAAjB,EACAD,CAAS,CAACE,MAAV,EACH,CALD,IAKO,CACHC,OAAO,CAACC,GAAR,CAAY,0BAAZ,CACH,CACJ,CATD,CAUH,CAlBD,CAmBH,CA/CE,CAsDHC,IAAI,CAAE,eAAW,CACb,GAAIC,CAAAA,CAAI,CAAG,IAAX,CAGAA,CAAI,CAACtB,cAAL,EACH,CA3DE,CA6DV,CAhEM,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Cross Enrollment Tool\n *\n * @package    block_lsuxe\n * @copyright  2008 onwards Louisiana State University\n * @copyright  2008 onwards David Lowe\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'block_lsuxe/notifications', 'block_lsuxe/xe_lib'],\n    function($, noti, XELib) {\n    'use strict';\n    return {\n\n        /**\n         * Register click events for the page.\n         *\n         * @param null\n         * @return void\n         */\n        registerEvents: function () {\n\n            $('.block_lsuxe_container .mview_update').on('click', function() {\n                // record will be the id of the record in the db\n                // var record = $(this).closest(\"tr\").data(\"rowid\");\n                // TODO: finish this by calling some scheduled task to run NOW.\n            });\n\n            $('.block_lsuxe_container .mview_edit').on('click', function(ev) {\n                ev.preventDefault();\n                var record = $(this).closest(\"tr\").data(\"rowid\"),\n                    send_this = {\n                        \"sentaction\": \"update\",\n                        \"sentdata\": record,\n                        \"vform\": \"1\"\n                    },\n                    url = sessionStorage.getItem(\"wwwroot\") + \"/blocks/lsuxe/\" + sessionStorage.getItem(\"xe_form\") + \".php\";\n                XELib.pushPost(url, send_this);\n            });\n\n            $('.block_lsuxe_container .mview_delete').on('click', function(ev) {\n                ev.preventDefault();\n\n                var row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"this_form\": $(this).closest(\"form\")\n                };\n\n                noti.callRemoveModi(row_data).then(function (response) {\n                    if (response.status == true) {\n                        var this_form = $('#map_form_'+response.data.record);\n                        // Convert all the form elements values to a serialised string.\n                        this_form.append('<input type=\"hidden\" name=\"sentaction\" value=\"delete\" />');\n                        this_form.submit();\n                    } else {\n                        console.log(\"NOPE the thingy is false\");\n                    }\n                });\n            });\n        },\n\n        /**\n         * Currently this is being called from the mustache templates when viewing lists.\n         * @param null\n         * @return void\n         */\n        init: function() {\n            var that = this;\n\n            // register events\n            that.registerEvents();\n        },\n    };\n});"],"file":"crud_buttons.min.js"}